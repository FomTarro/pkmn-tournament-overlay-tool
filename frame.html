<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <style>
            body {
                margin: 0;
            }
            .outline {
                filter: drop-shadow(1px 1px black) 
                    drop-shadow(-1px -1px black)
                    drop-shadow(1px -1px black)
                    drop-shadow(-1px 1px black) 
                    !important;
            }
            .shadow {
                filter: drop-shadow(
                    max(2px, 0.1em)
                    max(2px, 0.1em)
                    max(2px, 0.1em)
                    rgba(0, 0, 0, 0.5)) !important;
            }
            .shadow_outline {
                filter: drop-shadow(1px 1px black) 
                    drop-shadow(-1px -1px black)
                    drop-shadow(1px -1px black)
                    drop-shadow(-1px 1px black) 
                    drop-shadow(
                    max(2px, 0.1em)
                    max(2px, 0.1em)
                    max(2px, 0.1em)
                    rgba(0, 0, 0, 0.5)) 
                    !important;
            }
            .fill {
                height: 100%;
                width: 100%;
                position: relative;
                display: flex;
            }
            .mon {
                height: 100%;
                width: auto;
                position: relative;
                z-index: 1;
                object-fit: contain;
                display: block;
            }
            .item {
                width: auto;
                bottom: max(2px, 0.1em);
                right: max(2px, 0.1em);
                height: 35%;
                position: absolute;
                z-index: 2;
                display: block;
            }
            .tera {
                width: auto;
                top: max(2px, 0.1em);
                left: max(2px, 0.1em);
                height: 35%;
                position: absolute;
                z-index: 3;
                display: block;
            }
            .fainted {
                opacity: 50%;
            }
            .grid {
                display: flex;
                flex-wrap: wrap;
                align-items: center;
                justify-content: center;
                gap: 5vw;
                align-content: center;
            }
            .container {
                display: flex;
                flex-direction: column;
                align-content: center;
                align-items: center;
                justify-content: flex-start;
            }
            .single {
                width: 100vw;
                height: 100vh;
            }
            .ranking {
                width: 12vw;
                height: auto;
                aspect-ratio: 1;
            }
            .icon {
                height: 100%;
                width: 100%;
                display: flex;
                flex-direction: row;
                align-items: center;
                justify-content: center;
                position: relative;
            }
            .subtitle {
                font-size: 3vw;
            }
        </style>
    </head>
    <body class="fill">
        <div id="content" class="fill">
        </div>
        <template id="icon_template">
            <div class="container">
                <div class="icon">
                    <img class="mon" id="mon">
                    <img class="item" id="item">
                    <img class="tera" id="tera">
                </div>
                <div class="subtitle">55%</div>
            </div>
        </template>
    </body>
    <footer>
        <script>
            const urlParams = new URLSearchParams(window.location.search);
            const template = document.getElementById("icon_template");
            const mon = urlParams.get('img');
            if(mon){
                const display = template.content.cloneNode(true).querySelector(".container");
                display.classList.add('single');
                const monIcon = display.querySelector(".mon");
                monIcon.src = `./img/pkmn/${mon}.png`
                const item = urlParams.get('item');
                if(item){
                    const itemIcon = display.querySelector(".item");
                    itemIcon.src = `./img/items/${item}.png`
                    const used = urlParams.get('used');
                    if(used === 'true'){
                        itemIcon.classList.add('fainted')
                    }
                }
                const tera = urlParams.get('tera');
                if(tera){
                    const teraIcon = display.querySelector(".tera");
                    teraIcon.src = `./img/misc/tera/${tera}.png`
                }
                const fainted = urlParams.get('fainted');
                if(fainted === 'true'){
                    display.classList.add('fainted')
                }
                const percentage = display.querySelector('.subtitle');
                percentage.remove();
                document.getElementById('content').appendChild(display);
            } else {
                const params = urlParams.entries();
                document.getElementById('content').classList.add('grid');
                // TODO: filter just the numbers
                for(const [param, value] of params){
                    if(param != "effect"){
                        const display = template.content.cloneNode(true).querySelector(".container");
                        const monIcon = display.querySelector('.mon');
                        monIcon.src = `./img/pkmn/poke_icon_${param}.png`
                        const percentage = display.querySelector('.subtitle');
                        percentage.innerHTML = `${value}%`;
                        display.classList.add('ranking')
                        document.getElementById('content').appendChild(display);
                    }
                }
            }

            const effect = urlParams.get('effect')
            if(effect){
                const elems = document.querySelectorAll('.mon, .item, .tera');
                for(let elem of elems){
                    elem.classList.add(effect);
                }
            }
        </script>
    </footer>
</html>